# 💻 THE_JAVA_TEST
백기선, 더 자바, 애플리케이션을 테스트하는 다양한 방법

💡 이 레포지토리는 백기선님의 인프런 강의 [더 자바, 애플리케이션을 테스트하는 다양한 방법](https://www.inflearn.com/course/the-java-application-test)을 팔로우하고 있습니다.   
🔌 보다 자세한 내용과 설명은 백기선님의 온라인 강의를 듣는 것을 적극 추천드립니다.         
   
# Mockito   
**Mock**이란 진짜 객체와 비슷하게 동작하지만 **프로그래머가 직접 그 객체의 행동을 관리하는 모형 객체**를 의미한다.            
**Mockito**는 **`Mock 객체`를 쉽게 만들고 관리하고 검증**할 수 있는 방법을 제공하는 **테스팅 프레임워크다.**            
      
[JetBrains의 설문조사](https://www.jetbrains.com/lp/devecosystem-2019/java/)에 의하면 **자바 개발자가 가장 많이 사용한 Mock 프레임워크다.**       
          
## Mock이 필요한 이유      
  
**🤔 JUnit도 있는데 Mock 은 왜 필요한걸까?**   
애플리케이션이 데이터베이스를 사용, 외부 API 호출, 자사 플랫폼의 API 를 호출할만큼 복잡해졌다 가정한다.      
애플리케이션의 기능들을 검증하기 위해 `외부 API 호출`과 같은 작업들도 테스트해야 한다.           
       
하지만, 테스트를 진행함에 있어 **매번 `외부 API 호출`과 같은 작업을 하는 것은 매우 복잡하고 번거로운 일이다.**                    
특히 이러한 서비스를 테스팅하기 위해서는 **실제 서비스와 동일한 수준의 코드를 작성**해야하며                     
또한, 이러한 서비스 클래스들이 **미리 정의되어 있지 않는다면 테스트를 진행할 수도 없다.**                            
결국, **테스트라는 본질을 잃어버리고 하나의 서비스를 만드는 작업이 되어버린다.**           
     
Mock은 테스트에 필요한 서비스를 호출한다고 가정을 한 **모형 객체이다**            
Mock 객체를 이용해서 우리는 **실제 서비스를 이용하는 것처럼 기능을 테스트** 할 수 있다.            
Mock 객체를 이용해서 **구현되어 있지 않은 서비스를 예상하고 기능을 테스트** 할 수 있다.          
               
그렇기 때문에, `Mock`은 단순히 모형 객체가 아닌 **`테스트`라는 본연에 작업에 집중할 수 있게 해주는 객체이다.**           
    
**Mock이 필요한 상황을 정리해보면 아래와 같다.**
   
- 테스트 환경을 구축하는데 시간이 오래걸리는 경우   
- 특정 모듈을 갖고 있지 않아 테스트 환경을 구축하기 어려운 경우   
- API 호출 및 사용에 대한 협의나 정책이 필요한 경우  
- 테스트가 특정 경우나 순간에 의존적인 경우
- 테스트 시간이 오래 걸리는 경우        
- 개인 PC의 성능이나 서버의 성능문제로 테스트가 오래 걸릴수 있는 경우    
                
추가로,       
마틴 파울러가 작성한 [단위 테스트에 대한 고찰](https://martinfowler.com/bliki/UnitTest.html)을 한 번 읽어보자           

살짝 정리하자면 아래와 같습니다.   
```
모든 클래스/메서드를 Mock 으로 만들어 테스팅하는 것은 의존성을 완전히 차단하는 테스팅 방법이다.       
그렇기에 몇몇의 개발자들은 모든 의존성을 Mocking해야 한다고 주장을 한다.   
  
하지만, 마틴 파울러의 생각으로는 모든 의존성을 Mocking 할 필요는 없다고 주장한다.      
마틴 파울러의 주장에 따르면 클래스/메서드 뿐만 아니라 행동 또한 단위가 될 수 있다.     
그렇기 때문에 그 행동과 연관된 모든 객체들을 다 같이 테스트해도 된다고 말하고 있다.   

그리고 마틴  파울러가 말하길 이 같은 주장은 절대적인 것은 아니며   
Mocking의 대상 범위를 어디까지 지정할 것인지는 상황마다 다르므로 팀 내에서 의논을 하고 결정해야 한다고 주장한다.   
```
             
백기선님의 개인 의견은 아래와 같습니다.   
``` 
이미 구현된 클래스는 Mocking할 필요는 없다 생각한다.              
하지만, 외부 서비스는 개인이 컨트롤하기 힘들기 때문에 Mocking 하면 좋다 생각한다  
그래도 간혹 bango payment와 같은 테스트 환경을 제공해주는 외부 서비스가 있다.(결제 서비스를 프록시처럼 제공함)        
이 같은 외부 서비스는 테스트 환경을 제공(별도의 테스트 서버)하기 때문에 테스트를 작성할 때 Mocking을 하지 않는다.    

더 자세히 예를 들자면,  
StudyController, StudyService, StudyRepository   
와 같은 클래스들이 있을 때, 하나의 클래스만 고립시키고 테스팅하지는 않을 것이다.    
하나의 행위로 묶어서 그 자체로도 유닛 테스트라고 생각하고 테스팅할 것이다.     
```
어느 것이 옳다는 말은 없다.  
단, 본인의 기준을 잡되 유연하게 전환할 수 있는 사고를 가지자      







